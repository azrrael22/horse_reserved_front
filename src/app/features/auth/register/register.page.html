<ion-header class="ion-no-border">
  <ion-toolbar class="auth-toolbar"></ion-toolbar>
</ion-header>

<ion-content class="auth-content" [fullscreen]="true">

  <div class="auth-split">

    <!-- Panel decorativo (tablet/desktop) -->
    <div class="auth-hero" style="background: linear-gradient(145deg, #3D2B1F 0%, #8B5E3C 50%, #2D5A27 100%);">
      <div class="auth-hero-content">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:48px;">
          <div style="width:40px;height:40px;border-radius:50%;background:#C9972B;display:flex;align-items:center;justify-content:center;font-size:20px;">üê¥</div>
          <span style="font-size:18px;font-weight:600;letter-spacing:0.5px;">Cabalgatas Salento</span>
        </div>
        <div class="hero-accent"></div>
        <h1 class="hero-title">
          √önete a<br>
          nuestra<br>
          <span style="color:#C9972B;">aventura</span>
        </h1>
        <p class="hero-sub">
          Crea tu cuenta y empieza a reservar las mejores cabalgatas del eje cafetero.
        </p>
        <div style="display:flex;gap:24px;margin-top:24px;font-size:13px;color:rgba(255,255,255,0.6);">
          <span>‚úì Reservas en minutos</span>
          <span>‚úì Cancelaci√≥n flexible</span>
        </div>
      </div>
      <p class="hero-footer">Salento, Quind√≠o ¬∑ Colombia</p>
    </div>

    <!-- Formulario -->
    <div class="auth-form-side">
      <div style="width:100%;max-width:440px;">

        <!-- Logo mobile -->
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:28px;" class="ion-hide-md-up">
          <div style="width:36px;height:36px;border-radius:50%;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;font-size:18px;">üê¥</div>
          <span style="font-weight:600;color:var(--ion-color-primary);">Cabalgatas Salento</span>
        </div>

        <ion-card class="auth-card">
          <ion-card-header>
            <h2 class="auth-title font-display">Crear cuenta</h2>
            <p class="auth-subtitle">Completa tus datos para registrarte</p>
          </ion-card-header>

          <ion-card-content>

            <!-- Banner de error -->
            @if (error()) {
              <div class="cs-error-banner">
                <ion-icon name="alert-circle-outline" style="font-size:18px;"></ion-icon>
                <span>{{ error() }}</span>
              </div>
            }

            <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>

              <!-- Nombre y Apellido en grid -->
              <ion-grid style="padding:0;margin-bottom:0;">
                <ion-row>
                  <ion-col size="6" style="padding-left:0;padding-right:6px;">
                    <ion-item
                      class="cs-item"
                      [class.item-invalid]="f.primerNombre.invalid && f.primerNombre.touched"
                      lines="none"
                    >
                      <ion-icon name="person-outline" slot="start" color="medium"></ion-icon>
                      <ion-label position="stacked">Primer nombre <span style="color:var(--ion-color-danger)">*</span></ion-label>
                      <ion-input
                        type="text"
                        formControlName="primerNombre"
                        placeholder="Mar√≠a"
                        autocomplete="given-name"
                      ></ion-input>
                    </ion-item>
                    @if (f.primerNombre.invalid && f.primerNombre.touched) {
                      <p class="cs-error-msg"><ion-icon name="alert-circle-outline"></ion-icon> Obligatorio.</p>
                    }
                  </ion-col>
                  <ion-col size="6" style="padding-right:0;padding-left:6px;">
                    <ion-item
                      class="cs-item"
                      [class.item-invalid]="f.primerApellido.invalid && f.primerApellido.touched"
                      lines="none"
                    >
                      <ion-icon name="person-outline" slot="start" color="medium"></ion-icon>
                      <ion-label position="stacked">Primer apellido <span style="color:var(--ion-color-danger)">*</span></ion-label>
                      <ion-input
                        type="text"
                        formControlName="primerApellido"
                        placeholder="Garc√≠a"
                        autocomplete="family-name"
                      ></ion-input>
                    </ion-item>
                    @if (f.primerApellido.invalid && f.primerApellido.touched) {
                      <p class="cs-error-msg"><ion-icon name="alert-circle-outline"></ion-icon> Obligatorio.</p>
                    }
                  </ion-col>
                </ion-row>
              </ion-grid>

              <!-- Tipo de documento -->
              <ion-item class="cs-item" lines="none">
                <ion-icon name="card-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">Tipo de documento <span style="color:var(--ion-color-danger)">*</span></ion-label>
                <ion-select
                  formControlName="tipoDocumento"
                  interface="action-sheet"
                  placeholder="Selecciona..."
                >
                  @for (tipo of tiposDoc; track tipo.value) {
                    <ion-select-option [value]="tipo.value">{{ tipo.label }}</ion-select-option>
                  }
                </ion-select>
              </ion-item>

              <!-- N√∫mero de documento -->
              <ion-item
                class="cs-item"
                [class.item-invalid]="f.documento.invalid && f.documento.touched"
                lines="none"
              >
                <ion-icon name="card-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">N√∫mero de documento <span style="color:var(--ion-color-danger)">*</span></ion-label>
                <ion-input
                  type="text"
                  formControlName="documento"
                  placeholder="1234567890"
                ></ion-input>
              </ion-item>
              @if (f.documento.invalid && f.documento.touched) {
                <p class="cs-error-msg"><ion-icon name="alert-circle-outline"></ion-icon> Documento obligatorio.</p>
              }

              <!-- Tel√©fono -->
              <ion-item class="cs-item" lines="none">
                <ion-icon name="call-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">Tel√©fono <span style="font-size:11px;color:var(--ion-color-medium)">(opcional)</span></ion-label>
                <ion-input
                  type="tel"
                  formControlName="telefono"
                  placeholder="+57 300 000 0000"
                  autocomplete="tel"
                ></ion-input>
              </ion-item>

              <!-- Email -->
              <ion-item
                class="cs-item"
                [class.item-invalid]="f.email.invalid && f.email.touched"
                lines="none"
              >
                <ion-icon name="mail-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">Correo electr√≥nico <span style="color:var(--ion-color-danger)">*</span></ion-label>
                <ion-input
                  type="email"
                  formControlName="email"
                  placeholder="tu@correo.com"
                  autocomplete="email"
                  [clearInput]="true"
                ></ion-input>
              </ion-item>
              @if (f.email.invalid && f.email.touched) {
                <p class="cs-error-msg">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  @if (f.email.errors?.['required']) { El correo es obligatorio. }
                  @else { Ingresa un correo v√°lido. }
                </p>
              }

              <!-- Contrase√±a -->
              <ion-item
                class="cs-item"
                [class.item-invalid]="f.password.invalid && f.password.touched"
                lines="none"
              >
                <ion-icon name="lock-closed-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">Contrase√±a <span style="color:var(--ion-color-danger)">*</span></ion-label>
                <ion-input
                  [type]="showPass() ? 'text' : 'password'"
                  formControlName="password"
                  placeholder="M√≠nimo 8 caracteres"
                  autocomplete="new-password"
                ></ion-input>
                <ion-button slot="end" fill="clear" size="small" (click)="togglePass()">
                  <ion-icon [name]="showPass() ? 'eye-off-outline' : 'eye-outline'" color="medium"></ion-icon>
                </ion-button>
              </ion-item>
              @if (f.password.invalid && f.password.touched) {
                <p class="cs-error-msg"><ion-icon name="alert-circle-outline"></ion-icon> M√≠nimo 8 caracteres.</p>
              }

              <!-- Confirmar contrase√±a -->
              <ion-item
                class="cs-item"
                [class.item-invalid]="passMismatch"
                lines="none"
              >
                <ion-icon name="lock-closed-outline" slot="start" color="medium"></ion-icon>
                <ion-label position="stacked">Confirmar contrase√±a <span style="color:var(--ion-color-danger)">*</span></ion-label>
                <ion-input
                  [type]="showConfirm() ? 'text' : 'password'"
                  formControlName="confirmPassword"
                  placeholder="Repite tu contrase√±a"
                  autocomplete="new-password"
                ></ion-input>
                <ion-button slot="end" fill="clear" size="small" (click)="toggleConfirm()">
                  <ion-icon [name]="showConfirm() ? 'eye-off-outline' : 'eye-outline'" color="medium"></ion-icon>
                </ion-button>
              </ion-item>
              @if (passMismatch) {
                <p class="cs-error-msg"><ion-icon name="alert-circle-outline"></ion-icon> Las contrase√±as no coinciden.</p>
              }

              <!-- Submit -->
              <ion-button
                class="cs-btn-primary"
                expand="block"
                type="submit"
                [disabled]="form.invalid || loading()"
                style="margin-top:8px;"
              >
                @if (loading()) {
                  <ion-spinner name="crescent" slot="start"></ion-spinner>
                  Creando cuenta...
                } @else {
                  Crear cuenta
                }
              </ion-button>

            </form>

            <!-- Separador -->
            <div class="cs-divider">
              <div class="cs-divider-line"></div>
              <span>o reg√≠strate con</span>
              <div class="cs-divider-line"></div>
            </div>

            <!-- Google -->
            <ion-button
              class="cs-btn-google"
              expand="block"
              fill="outline"
              (click)="loginWithGoogle()"
            >
              <svg slot="start" width="20" height="20" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
              Continuar con Google
            </ion-button>

            <p style="text-align:center;margin-top:20px;font-size:14px;color:var(--ion-color-medium);">
              ¬øYa tienes cuenta?
              <a routerLink="/auth/login"
                style="color:var(--ion-color-primary);font-weight:700;text-decoration:none;margin-left:4px;">
                Inicia sesi√≥n
              </a>
            </p>

          </ion-card-content>
        </ion-card>

      </div>
    </div>
  </div>

</ion-content>
